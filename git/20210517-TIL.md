# 20210517 TIL

- HTTP 캐시 기본 동작<br>
캐시가 없을 때 있을 때, 캐시 시간이 초과돼었을 때의 동작

- HTTP 검증 헤더와 조건부 요청<br>
검증헤더 : `Last-Modified`, `ETag`<br>
조건부 요청 헤더: `If-Modified-Since`, `If-None-Match`

- 프록시 캐시<br>
CDN과 AWS-Cloud Front에 대해서 조금 더 알아봐야겠다.

- 캐시 무효화<br>
```
Cache-Control: no-cache, no-store, must-revalidate
Pragma: no-cache
```
캐시 무효화를 해야하는 예시 => 이체 후 통장 잔고 갱신

>> 캐시 무효화가 필요한 이유가 뭘까? 서버에서 캐시를 적용하지 않으면 적용 안되는 것 아닌가?

아니다. 웹 브라우저들이 임의로 요청할 때 캐시를 해버리기도 한다.

>> no-cache만 쓰면 되지 왜 must-revalidate까지 사용해야 될까?

`no-cache`는 프록시 서버를 통해 origin서버로 접근해야할 때 만약 순간적인 네트워크가 단절 된다면,
캐시서버 설정에 따라 프록시 서버에서 캐시 데이터를 반환할 수도 있다.<br>
즉, 에러를 반환해야될 상황에 오래된 데이터를 보여줄 수 도 있다.<br>
ex) 입금이 되고 통장 잔고를 확인했는데 돈이 안들어와있는 것 처럼 보일 수도...

>> no-store 만으로도 충분히 무효화 가능하지 않을까?

그렇게 되야 하는게 맞지만, HTTP 스펙이라는 것이 디테일하게 들어가면 모호한 부분들이 존재한다. 예를 들어 브러우저 앞으로 가기, 뒤로 가기도 캐시로 볼 것인가? 오래된 브라우저와의 호환, 버그, 수 많은 프록시 캐시 업체들과 구현된 서버 등..<br>
결국 확실한 캐시 무효화를 위해서 여러 지시어를 같이 사용해야 한다.




